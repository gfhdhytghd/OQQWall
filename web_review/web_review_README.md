# OQQWall 网页审核面板

## 📋 项目概述

OQQWall 网页审核面板是一个现代化的 Web 界面，专为 OQQWall 校园墙系统设计。它提供了直观、高效的投稿内容审核功能，帮助管理员快速处理用户投稿。

## ✨ 核心特性

### 🎨 Material Design 3 界面
- 采用最新的 Material Design 3 设计语言
- 紫色主题配色方案，现代化视觉效果
- 响应式设计，完美支持桌面和移动设备
- 圆角卡片布局，优雅的阴影效果
- 流畅的动画和过渡效果

### 📊 实时数据统计
- **待审核项目总数**: 实时显示待处理投稿数量
- **匿名投稿统计**: 显示匿名投稿的比例
- **图片投稿统计**: 统计包含图片的投稿数量
- **活跃群组数量**: 显示有投稿的群组数量
- **自动更新**: 每10秒自动刷新统计数据

### 🔍 智能搜索与筛选
- **群组筛选**: 按特定群组筛选投稿内容
- **关键词搜索**: 支持按用户ID、昵称、内容搜索
- **实时搜索**: 输入即时显示搜索结果
- **搜索高亮**: 搜索结果中的关键词高亮显示

### ⚡ 高效审核操作
- **一键审核**: 通过、拒绝、删除等操作
- **批量处理**: 支持批量审核操作
- **匿名切换**: 快速切换投稿的匿名状态
- **评论系统**: 为投稿添加审核评论
- **用户管理**: 拉黑违规用户功能

### 🖼️ 图片预览系统
- **缩略图展示**: 投稿图片的缩略图预览
- **点击放大**: 点击图片查看高清大图
- **多图支持**: 支持多张图片的展示
- **懒加载**: 图片懒加载优化性能

### 🔄 智能刷新机制
- **自动刷新**: 用户无活动时自动刷新页面
- **实时更新**: 统计数据实时更新
- **页面检测**: 基于页面可见性的智能刷新
- **手动刷新**: 支持手动刷新和快捷键刷新

### ⌨️ 键盘快捷键
- `Ctrl + R`: 刷新页面
- `Ctrl + F`: 聚焦搜索框
- `Enter`: 提交搜索
- `Esc`: 取消操作

## 🚀 快速开始

### 环境要求

- **Python**: 3.7 或更高版本
- **操作系统**: Windows, Linux, macOS
- **浏览器**: Chrome, Firefox, Safari, Edge (现代浏览器)
- **依赖**: 仅使用 Python 标准库，无需额外安装

### 启动服务

```bash
# 进入 web_review 目录
cd web_review/

# 基本启动（默认端口 8090，监听所有接口）
python3 web_review.py

# 指定端口启动
python3 web_review.py --port 8090

# 仅本地访问
python3 web_review.py --host 127.0.0.1 --port 8090

# 查看帮助信息
python3 web_review.py --help
```

### 访问界面

启动成功后，在浏览器中访问：
- **本地访问**: `http://localhost:8090`
- **外部访问**: `http://YOUR_SERVER_IP:8090`

## 📖 使用指南

### 主界面功能

1. **统计面板**: 显示待审核项目、匿名投稿、图片投稿等统计信息
2. **搜索筛选**: 支持按群组筛选和关键词搜索
3. **投稿列表**: 以卡片形式展示所有待审核的投稿

### 审核操作详解

#### 基础审核操作
- ✅ **通过(入暂存)**: 将投稿加入暂存区，等待系统自动发送
- 🚀 **立即发送**: 立即发布到QQ空间
- ❌ **拒绝**: 拒绝投稿并通知用户
- 🗑️ **删除**: 删除投稿（不可恢复）

#### 高级操作
- ⚠️ **人工处理**: 标记需要人工处理的投稿
- 👤 **切换匿名**: 切换投稿的匿名状态
- 🔄 **刷新**: 重新处理投稿数据
- 🎨 **重渲染**: 重新生成HTML预览
- 📢 **展示到群**: 在群中展示投稿内容
- ℹ️ **查成分**: 查看用户详细信息

#### 用户管理
- 🚫 **拉黑**: 将违规用户加入黑名单
- 💬 **评论**: 为投稿添加审核评论

### 详情页面功能

点击"📋 详情"按钮进入详情页面，可以查看：

1. **渲染预览**: 由 `gotohtml.sh` 生成的HTML预览
2. **图片文件**: 投稿中的所有图片文件
3. **原始数据**: AfterLM JSON 格式的原始数据
4. **完整操作**: 所有可用的审核操作按钮

### 搜索和筛选

- **群组筛选**: 在群组筛选框中输入群组名称
- **关键词搜索**: 在搜索框中输入关键词，支持搜索：
  - 用户ID
  - 用户昵称
  - 投稿内容
  - 投稿标签

## 技术特性

### 安全性
- 输入验证和转义
- 文件路径安全检查
- 命令执行超时保护

### 性能优化
- 数据库查询优化
- 图片懒加载
- 智能缓存机制

### 用户体验
- 操作确认对话框
- 加载状态指示
- 错误处理和提示
- 响应式设计

## 配置说明

### 端口配置

在 `oqqwall.config` 文件中设置：

```ini
web_review_port=8090
```

### 依赖要求

- Python 3.7+
- 标准库模块（无需额外安装）
- 确保 `getmsgserv/processsend.sh` 脚本可执行

## 故障排除

### 常见问题

1. **端口被占用**
   ```bash
   # 使用其他端口
   python3 web_review.py --port 8091
   ```

2. **图片无法显示**
   - 检查 `cache/prepost/` 和 `cache/picture/` 目录权限
   - 确认图片文件存在

3. **审核命令执行失败**
   - 检查 `getmsgserv/processsend.sh` 脚本权限
   - 查看终端输出的错误信息

4. **数据库连接问题**
   - 确认 `cache/OQQWall.db` 文件存在
   - 检查数据库文件权限

### 日志查看

所有操作都会在终端输出详细日志，包括：
- 命令执行状态
- 错误信息
- 性能统计

## 更新日志

### v2.0.0 (当前版本)
- 全新的现代化界面设计
- 实时统计和自动刷新
- 增强的搜索和筛选功能
- 改进的图片预览体验
- 键盘快捷键支持
- 更好的错误处理

### v1.0.0 (原版本)
- 基础的审核功能
- 简单的列表界面
- 基本的操作按钮

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 许可证

与 OQQWall 主项目保持一致。



# OQQWall 网页端审核系统

## 概述

这是一个为 OQQWall 校园墙系统设计的现代化网页端审核界面，提供了直观、高效的投稿内容审核功能。

## 主要功能

### 🎨 现代化界面设计
- 采用渐变背景和毛玻璃效果
- 响应式设计，支持移动端
- 直观的卡片式布局
- 丰富的图标和颜色编码

### 📊 实时统计信息
- 待审核项目总数
- 匿名投稿数量
- 包含图片的投稿数量
- 活跃群组数量
- 自动更新统计信息

### 🔍 强大的筛选功能
- 按群组筛选投稿
- 按用户ID、昵称或内容搜索
- 实时搜索结果

### ⚡ 高效的操作界面
- 一键审核操作（通过、拒绝、删除等）
- 批量操作支持
- 匿名状态切换
- 评论添加功能
- 用户拉黑功能

### 🖼️ 图片预览功能
- 缩略图展示
- 点击查看大图
- 图片文件名显示

### 🔄 自动刷新机制
- 智能自动刷新（用户无活动时）
- 实时统计更新
- 页面可见性检测

### ⌨️ 键盘快捷键
- `Ctrl+R`: 刷新页面
- `Ctrl+F`: 聚焦搜索框

## 使用方法

### 启动服务

```bash
# 基本启动
python3 web_review.py

# 指定端口
python3 web_review.py --port 8090
```

### 访问界面

打开浏览器访问：`http://localhost:8090`

### 审核操作

1. **查看投稿列表**：主页显示所有待审核的投稿
2. **筛选内容**：使用群组筛选或搜索功能
3. **审核操作**：
   - ✅ **通过(入暂存)**：将投稿加入暂存区
   - 🚀 **立即发送**：立即发布到QQ空间
   - ❌ **拒绝**：拒绝投稿并通知用户
   - 🗑️ **删除**：删除投稿
   - ⚠️ **人工处理**：标记需要人工处理
   - 👤 **切换匿名**：切换匿名状态
   - 🔄 **刷新**：重新处理投稿
   - 🎨 **重渲染**：重新生成预览
   - 📢 **展示到群**：在群中展示投稿

4. **添加评论**：为投稿添加审核评论
5. **拉黑用户**：将违规用户加入黑名单

### 详情页面

点击"📋 详情"按钮可以查看：
- 完整的渲染预览
- 所有图片文件
- 原始 AfterLM JSON 数据
- 完整的操作选项

## 技术特性

### 安全性
- 输入验证和转义
- 文件路径安全检查
- 命令执行超时保护

### 性能优化
- 数据库查询优化
- 图片懒加载
- 智能缓存机制

### 用户体验
- 操作确认对话框
- 加载状态指示
- 错误处理和提示
- 响应式设计

## 配置说明

### 端口配置

在 `oqqwall.config` 文件中设置：

```ini
web_review_port=8090
```

### 依赖要求

- Python 3.7+
- 标准库模块（无需额外安装）
- 确保 `getmsgserv/processsend.sh` 脚本可执行

## 故障排除

### 常见问题

1. **端口被占用**
   ```bash
   # 使用其他端口
   python3 web_review.py --port 8091
   ```

2. **图片无法显示**
   - 检查 `cache/prepost/` 和 `cache/picture/` 目录权限
   - 确认图片文件存在

3. **审核命令执行失败**
   - 检查 `getmsgserv/processsend.sh` 脚本权限
   - 查看终端输出的错误信息

4. **数据库连接问题**
   - 确认 `cache/OQQWall.db` 文件存在
   - 检查数据库文件权限

### 日志查看

所有操作都会在终端输出详细日志，包括：
- 命令执行状态
- 错误信息
- 性能统计

## 更新日志

### v2.0.0 (当前版本)
- 全新的现代化界面设计
- 实时统计和自动刷新
- 增强的搜索和筛选功能
- 改进的图片预览体验
- 键盘快捷键支持
- 更好的错误处理

### v1.0.0 (原版本)
- 基础的审核功能
- 简单的列表界面
- 基本的操作按钮

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 许可证

与 OQQWall 主项目保持一致。


